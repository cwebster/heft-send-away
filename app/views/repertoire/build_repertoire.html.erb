<% content_for :javascript do %>
<%= javascript_include_tag 'dataTables/datatables.min', 'data-turbolinks-track' => true %>
<%= javascript_include_tag 'repertoire/build_repertoire', 'data-turbolinks-track' => true %>
<% end %>
<div class='wrapper wrapper-content animated fadeInRight'>
	<div class='row'>
		<div class='col-lg-12'>
			<div class='ibox float-e-margins'>
				<div class="ibox-content">
				<%= form_tag(controller: "repertoire", action: "add_to_repertoire", method: "post",params: {laboratory_id: @laboratory.id}) do %>
					<table class="table table-striped table-bordered table-hover dataTable" id="build_repertoire" aria-describedby="DataTables_Table_0_info" role="grid">
						<thead>
							<tr role="row">
								<th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Activate to sort column descending">Provider Name </th>
								<th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Activate to sort column descending">Analyte Name </th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">EQA Status</th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">Turnaround Time</th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">UKAS Status</th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">Methodology</th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">Reference Range</th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">Sample</th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">Cost</th>
								<th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Activate to sort column ascending">Add to Repertoire</th>
							</tr>
						</thead>
						<tbody>
                          <% @laboratory_tests.each do |laboratory_test| %>
							<tr class="gradeA" role="row">
								<td> 
								<div class="table-cell-toolbar-container">
								<%=laboratory_test.laboratory.laboratory_name%>
								, 
                                <%=laboratory_test.laboratory.address1%>
								, 
								<%=laboratory_test.laboratory.address2%>
								, 
								<%=laboratory_test.laboratory.postcode%>
								<p></p><p></p>
								  <div class="table-cell-toolbar">
									<a href="<%=laboratory_path(laboratory_test.laboratory)%>"><i class="fa fa-edit"></i> View Details</a>
								  </div>
								</div>
								</td>
								<td> 
								<div class="table-cell-toolbar-container">
								<%=laboratory_test.analyte_name%>
								  <div class="table-cell-toolbar">
								    <a href="<%=laboratory_path(laboratory_test.laboratory)%>"><i class="fa fa-edit"></i> View Details</a> 
								  </div>
								</div>
								</td>
								<td><%=laboratory_test.eqa_status%>
								</td>
								<td><%=laboratory_test.turnaround_time%>
								</td>
								<td><%=laboratory_test.ukas_status%>
								</td>
								<td><%=laboratory_test.methodology%>
								</td>
								<td><%=laboratory_test.reference_range%>
								</td>
								<td><%=laboratory_test.sample_type%>
								</td>
								<td><%=laboratory_test.cost_of_test%>
								</td>
								<% if Repertoire.in_repertoire?(laboratory_id: @laboratory.id ,laboratory_test_id: laboratory_test.id ) %>
								<td><%= check_box_tag "checks[#{@laboratory.id}_#{laboratory_test.id}]", true, checked = true %>
								</td>
								<% else %>
								<td><%= check_box_tag "checks[#{@laboratory.id}_#{laboratory_test.id}]", true, checked = false %>
								</td>
								<% end %>
							</tr>
						<%end%>
					<%end%>
						</tbody>
					</table>
					<%=button_tag "Build Repertoire", class: "btn btn-outline btn-warning"%>
				</div>
			</div>
		</div>
	</div>
</div>
